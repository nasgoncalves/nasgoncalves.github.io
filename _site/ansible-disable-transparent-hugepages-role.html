<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="description" content="0x00000001">
      <meta name="author" content="NASG">
      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="/css/main.css">
      <link rel="stylesheet" href="/css/normalize.css">
      <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
      <link rel="icon" href="/favicon.ico" type="image/x-icon">
      <link rel="alternate" type="application/atom+xml" href="/atom.xml">
      <title>Ansible Disable Transparent Hugepages Role</title>
   </head>
   
   <body>
      <main>
         <header>
            <h1 class="title"><a href="/">0x00000001</a></h1>
         </header>

         <article>
   <h2>Ansible Disable Transparent Hugepages Role</h2>
   <div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Disable thp</span>
  <span class="na">shell</span><span class="pi">:</span> <span class="s">echo 'never' &gt; ""</span>
  <span class="na">with_items</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/transparent_hugepage/enabled</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/transparent_hugepage/defrag</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/redhat_transparent_hugepage/enabled</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/redhat_transparent_hugepage/defrag</span>
  <span class="na">when</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">ignore_errors</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">become</span><span class="pi">:</span> <span class="s">yes</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Disable thp after every init script had initialized</span>
  <span class="na">lineinfile</span><span class="pi">:</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s">/etc/rc.d/rc.local</span>
    <span class="na">insertafter</span><span class="pi">:</span> <span class="s">EOF</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
    <span class="na">create</span><span class="pi">:</span> <span class="s">yes</span>
    <span class="na">line</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="no">if test -f ; then</span>
      <span class="no">echo never &gt; </span>
      <span class="no">fi</span>
    <span class="na">mode</span><span class="pi">:</span> <span class="s">0744</span>
  <span class="na">with_items</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/transparent_hugepage/enabled</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/transparent_hugepage/defrag</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/redhat_transparent_hugepage/enabled</span>
    <span class="pi">-</span> <span class="s">/sys/kernel/mm/redhat_transparent_hugepage/defrag</span>
  <span class="na">become</span><span class="pi">:</span> <span class="s">yes</span>

</code></pre></div>
<ul>
<li><a href="https://techoverflow.net/2013/08/01/checking-if-hugepages-are-enabled-in-linux/">Checking if Hugepages are enabled in Linux
</a></li>
<li><a href="https://access.redhat.com/solutions/46111">How to use, monitor, and disable transparent hugepages in Red Hat Enterprise Linux 6?</a></li>
</ul>

</article>

<footer>
   <div id="date" class="meta">
      11 Dec 2017
   </div>
   <div id="return">
      <a href="/">&lt;&lt;&lt;</a>
   </div>
</footer>

      </main>
   </body>
</html>
